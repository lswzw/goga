!function(){"use strict";async function t(t,n){const e=function(t){const n=window.atob(t),e=n.length,o=new Uint8Array(e);for(let t=0;t<e;t++)o[t]=n.charCodeAt(t);return o.buffer}(t),o=await window.crypto.subtle.importKey("raw",e,{name:"AES-GCM"},!1,["encrypt"]),r=(new TextEncoder).encode(n),a=window.crypto.getRandomValues(new Uint8Array(12)),i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:a},o,r),c=new Uint8Array(a.length+i.byteLength);return c.set(a,0),c.set(new Uint8Array(i),a.length),function(t){let n="";const e=new Uint8Array(t),o=e.byteLength;for(let t=0;t<o;t++)n+=String.fromCharCode(e[t]);return window.btoa(n)}(c.buffer)}const n=window.fetch;window.fetch=async function(...e){const[o,r]=e;if(r&&r.method&&"POST"===r.method.toUpperCase()&&r.body&&"string"==typeof r.body&&!o.toString().includes("/goga/api/v1/key"))try{JSON.parse(r.body);const e=r.body,a=await n("/goga/api/v1/key");if(!a.ok)throw new Error("无法获取加密密钥。");const{key:i,token:c}=await a.json(),w={token:c,encrypted:await t(i,e)},y={...r};return y.body=JSON.stringify(w),y.headers={...y.headers,"Content-Type":"application/json"},n(o,y)}catch(t){return n(...e)}return n(...e)}}();